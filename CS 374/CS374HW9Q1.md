##### (a)

$V' = V \cross \{\inf, 0, 1, ..., D \} \cross \{F, T\}$

for $e = (v, u) \in E$

if at $v \in X$ and $g > 1$

* $(v, g, p) \to (u, g - 1, T)$

if at $v \in Y$

* $(v, g, p) \to (u, \inf, p)$

if $g > 1$

* $(v, g, p) \to (u, g - 1, p)$

Run Dijkstra on $G' = (V', E')$. From $(s, D, F)$ to $(t, g, T)$. Find minimum of all $dist((t, g, T))$

Should be $|V'| = O(DV)$, and $|E'| = O(DE)$, and therefore
$$
O(D(V\log DV + E))
$$

##### (b)

$V' = V \cross \{0, 1, ..., R \} \cross \{F, T\}$

for $e = (v, u) \in E$

if at $v \in X$ and $g > 1$

* $(v, g, p) \to (u, g - 1, T)$

if at $v \in Y$

* $(v, g, p) \to (u, R, p)$

if $g > 1$

* $(v, g, p) \to (u, g - 1, p)$

Run Dijkstra on $G' = (V', E')$. From $(s, R, F)$ to $(t, g, T)$. Find minimum of all $dist((t, g, T))$

Should be $|V'| = O(RV)$, and $|E'| = O(RE)$, and therefore
$$
O(R(V\log RV + E))
$$